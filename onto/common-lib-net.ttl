@prefix s-wfb: <http://semantic-machines.com/veda/simple-workflow-base/> .
@prefix : <http://semantic-machines.com/veda/simple-workflow/> .
@prefix s-wf: <http://semantic-machines.com/veda/simple-workflow/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix v-wf: <http://semantic-machines.com/veda/veda-workflow/> .
@prefix v-s: <http://semantic-machines.com/veda/veda-schema/> .
@prefix v-ui: <http://semantic-machines.com/veda/veda-ui/> .
@prefix td: <http://semantic-machines.com/veda/test-data/> .
@prefix d: <http://semantic-machines.com/veda/veda-data/>.
@prefix cfg: <http://semantic-machines.com/veda/config/> .
@prefix v-ft: <http://semantic-machines.com/veda/veda-function-tasks/> .

<http://semantic-machines.com/veda/simple-workflow>
  rdf:type owl:Ontology ;
  owl:imports <http://semantic-machines.com/veda/veda-workflow> ;
  rdfs:label "Онтология бизнес процессов базовая"@ru ;
  rdfs:label "Simple workflow base ontology"@en ;
  v-s:loadPriority 21 ;
.

#------------------------Строки----------
v-s:TaskIsRedirectedFrom
  rdf:type v-s:Bundle ;
  rdfs:label "Задача перенаправлена"@ru ;
  rdfs:label "Task was redirected by"@en ;
.

v-s:OverloadNotificationMessage
  rdf:type v-s:Bundle ;
  rdfs:label "В связи с загруженностью системы, функция ответа на задачу времено недоступна. Попробуйте позже."@ru ;
  rdfs:label "Task was redirected by"@en ;
.
# -----------------------------------------------

s-wf:EmptyTask
    rdf:type v-wf:DecisionForm ;
    rdfs:label "";
.

s-wf:var_initiator
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "initiator" ;
  rdfs:label "Инициатор"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_controller
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "controller" ;
  rdfs:label "Контролирующий"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_responsible
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "responsible" ;
  rdfs:label "Ответственный"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_rightset
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "rightset" ;
  rdfs:label "Права на документ"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_task_comment
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "taskComment" ;
  rdfs:label "Комментарий к задаче"@ru ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_dateTo
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "taskDateTo" ;
  rdfs:label "Контрольный срок задачи"@ru ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_set_status
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "setStatus" ;
  rdfs:label "Установка статусов"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:map_set_status
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_set_status ;
  v-wf:mappingExpression "process.getInputVariable ('setStatus')" ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_actor_task_add_to_date_to
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "actor_task_add_to_date_to" ;
  rdfs:label "Количество дней к дате контрольного срока задачи"@ru ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_doc_id
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "docId" ;
  rdfs:label "Id документа"@ru ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_startForm_id
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "startForm_id" ;
  rdfs:label "Id стартовой формы"@ru ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_coordinator
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "coordinator" ;
  rdfs:label "Список согласующих"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_documentType
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "documentType" ;
  rdfs:label "тип документа"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_actor
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "actor" ;
  rdfs:label "Исполнители"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_add_request_actor
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "add_request_actor" ;
  rdfs:label "Исполнители дополнительного запроса"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_result_decision
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "result_decision" ;
  rdfs:label "Полученное решение пользователя"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_result_decision_nct2
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "result_decision_nct2" ;
  rdfs:label "Полученное решение пользователя nct2"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_last_actor
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "last_actor" ;
  rdfs:label "Last actor" ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_decision_of_set_responsible
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "decision_of_set_responsible" ;
  rdfs:label "Решение о назначении исполнителей"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_decision_form_type
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "decision_form_type" ;
  rdfs:label "Decision form type"@ru ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_signer
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "signer" ;
  rdfs:label "Подписывающий"@ru ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_reviewer
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "reviewer" ;
  rdfs:label "Рассматривающий"@ru ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:var_right_1
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineScope v-wf:Net ;
  v-wf:varDefineName "originalRights" ;
  rdfs:label "Исходные права на документ"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_result
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineScope v-wf:Net ;
  v-wf:varDefineName "result" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:possible_decision
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "possible_decision" ;
  rdfs:label "Возможные варианты решения"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:decision_route_to_add_reaction
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "decision_route_to_add_reaction" ;
  rdfs:label "Решение для перехода к дополнительной реакции пользователя"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:possible_decision_for_add_reaction
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "possible_decision_for_add_reaction" ;
  rdfs:label "Возможные дополнительные варианты решения"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

# --------------------------------

s-wf:map_possible_decision
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:possible_decision ;
  v-wf:mappingExpression "process.getInputVariable ('possible_decision')" ;
.

s-wf:possible_decision_after_return
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:possible_decision ;
  v-wf:mappingExpression "[veda.Util.newUri('v-wf:DecisionAcceptMotivatedRefusal'), veda.Util.newUri ('v-wf:DecisionRemake'), veda.Util.newUri('v-wf:DecisionRedirect')]" ;
.
s-wf:possible_decision_for_controller
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:possible_decision ;
  v-wf:mappingExpression "[veda.Util.newUri('v-wf:DecisionConfirm'), veda.Util.newUri ('v-wf:DecisionRemake'), veda.Util.newUri('v-wf:DecisionRedirect')]" ;
.
s-wf:map_decision_route_to_add_reaction
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:decision_route_to_add_reaction ;
  v-wf:mappingExpression "process.getInputVariable ('decision_route_to_add_reaction')" ;
.

s-wf:map_possible_decision_for_add_reaction
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:possible_decision_for_add_reaction ;
  v-wf:mappingExpression "process.getInputVariable ('possible_decision_for_add_reaction')" ;
.

s-wf:map_decision_of_set_responsible
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_decision_of_set_responsible ;
  v-wf:mappingExpression "task_result.getValue ('result_decision')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_result_decision_from_task_result
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_result_decision ;
  v-wf:mappingExpression "task_result.getValue ('result_decision')";
  rdfs:isDefinedBy s-wf: ;
.


s-wf:map_last_actor_4_TR_last_actor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_last_actor ;
  v-wf:mappingExpression "task_result.getValue ('last_actor')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_initiator_4_PLV_last_actor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_initiator ;
  v-wf:mappingExpression "process.getLocalVariable ('last_actor')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_get_rights
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_right_1 ;
  v-wf:mappingExpression "task_result.getValue ('right')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_get_rightset
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_rightset ;
  v-wf:mappingExpression "process.getInputVariable ('rightset')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_orig_rights
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_right_1 ;
  v-wf:mappingExpression "process.getInputVariable ('originalRights')" ;
  rdfs:isDefinedBy s-wf: ;
.

#---------------------------------

s-wf:map_initiator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_initiator ;
  v-wf:mappingExpression "process.getInputVariable ('initiator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_responsible
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_responsible ;
  v-wf:mappingExpression "process.getInputVariable ('initiator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_actor_task_add_to_date_to
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_add_to_date_to ;
  v-wf:mappingExpression "process.getInputVariable ('taskAddToDateTo')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_initiator_from_actor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_initiator ;
  v-wf:mappingExpression "process.getLocalVariable ('actor')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_initiator_4_PLV_initiator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_initiator ;
  v-wf:mappingExpression "process.getLocalVariable ('initiator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_from_4_PLV_initiator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_from ;
  v-wf:mappingExpression "process.getLocalVariable ('initiator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_controller_4_PLV_controller
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_controller ;
  v-wf:mappingExpression "process.getLocalVariable ('controller')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_doc_id
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_doc_id ;
  v-wf:mappingExpression "process.getInputVariable ('docId')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_redirect_from_4_PLV_redirect_from
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_redirect_from ;
  v-wf:mappingExpression "process.getLocalVariable ('redirect_from')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_decision_form_type_4_PLV_decision_form_type
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_decision_form_type ;
  v-wf:mappingExpression "process.getLocalVariable ('decision_form_type')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_decision_form_type_4_PIV_decision_form_type
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_decision_form_type ;
  v-wf:mappingExpression "process.getInputVariable ('decision_form_type')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_actor_task_action_4_PIV_actor_task_action
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_action ;
  v-wf:mappingExpression "process.getInputVariable ('actor_task_action')" ;
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "actor_task_action <- actor_task_action" ;
.

s-wf:map_coordinator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_coordinator ;
  v-wf:mappingExpression "process.getInputVariable ('coordinator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_project2_to_docId
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_doc_id ;
  v-wf:mappingExpression "process.getLocalVariable ('project2')" ;
  rdfs:isDefinedBy s-wf: ;
.
#----

s-wf:executor_signer
  rdf:type v-wf:ExecutorDefinition ;
  v-wf:executorExpression "process.getInputVariable ('signer')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:executor_initiator
  rdf:type v-wf:ExecutorDefinition ;
  v-wf:executorExpression "process.getInputVariable ('initiator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:executor_reviewer
  rdf:type v-wf:ExecutorDefinition ;
  v-wf:executorExpression "process.getInputVariable ('reviewer')" ;
  rdfs:isDefinedBy s-wf: ;
.

# ------------------------------- var + map : "Проверить, запущен ли?" ---------------- #

s-wf:var_result_t1
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "res" ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:map_t1_e
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_result_t1 ;
  v-wf:mappingExpression "task_result.getValue ('res')" ;
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Вытащить из задачи результаты работы"@ru ;
.

s-wf:SimpleRouteStartForm
  rdf:type rdfs:Class ;
  rdfs:subClassOf v-s:Embedded ;
  rdfs:subClassOf v-wf:StartForm ;
  rdfs:subClassOf v-s:AutomaticallyVersioned ;
  rdfs:subClassOf v-s:Journaling ;
  rdfs:label "Стартовая форма сети Простой маршрут"@ru ;
  rdfs:label "Simple route start form"@en ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_participant
  rdf:type rdf:Property ;
  rdfs:label "Кому"@ru ;
  rdfs:label "To"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range v-s:Appointment ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_possible_decisions
  rdf:type rdf:Property ;
  rdfs:label "Варианты ответа"@ru ;
  rdfs:label "Possible decisions"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range owl:Class ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_task_label
  rdf:type rdf:Property ;
  rdfs:label "Название задачи"@ru ;
  rdfs:label "Task label"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range xsd:string ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_comment
  rdf:type rdf:Property ;
  rdfs:label "Комментарий"@ru ;
  rdfs:label "Comment"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range xsd:string ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_visible
  rdf:type rdf:Property ;
  rdfs:label "Видимый"@ru ;
  rdfs:label "Visible"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range xsd:boolean ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_editable
  rdf:type rdf:Property ;
  rdfs:label "Редактируемый"@ru ;
  rdfs:label "Editable"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range xsd:boolean ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_controlled
  rdf:type rdf:Property ;
  rdfs:label "Контролируемый"@ru ;
  rdfs:label "Controlled"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range xsd:boolean ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_controller
  rdf:type rdf:Property ;
  rdfs:label "Контролирующий"@ru ;
  rdfs:label "Controller"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range v-s:Appointment ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_deadlineDate
  rdf:type rdf:Property ;
  rdfs:label "Контрольный срок"@ru ;
  rdfs:label "Deadline"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range xsd:dateTime ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_deadlineDays
  rdf:type rdf:Property ;
  rdfs:label "Контрольный срок (дней)"@ru ;
  rdfs:label "Deadline (days)"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range xsd:integer ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:SimpleRouteStartForm_actions
  rdf:type rdf:Property ;
  rdfs:label "Actions"@ru ;
  rdfs:label "Actions"@en ;
  rdfs:domain s-wf:SimpleRouteStartForm ;
  rdfs:range v-s:Action ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:pm_sf
  rdf:type v-s:PermissionStatement ;
  v-s:canCreate "true"^^xsd:boolean ;
  v-s:permissionObject s-wf:SimpleRouteStartForm;
  v-s:permissionSubject cfg:AllUsersGroup ;
.

s-wf:SimpleRouteStartFormMinimal_Template
  rdf:type v-ui:ClassTemplate ;
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Шаблон стартовых данных простого маршрута"@ru ;
  rdfs:label "Single route start form template"@en ;
  v-ui:template """
<div>
  <em about="s-wf:SimpleRouteStartForm_participant" property="rdfs:label"></em>
  <div rel="s-wf:SimpleRouteStartForm_participant" class="view edit -search" data-template="v-ui:LabelTemplate"></div>
  <veda-control data-type="link" rel="s-wf:SimpleRouteStartForm_participant" class="-view edit search fulltext"></veda-control>
  <em about="s-wf:SimpleRouteStartForm_comment" property="rdfs:label"></em>
  <div property="s-wf:SimpleRouteStartForm_comment" class="view -edit -search"></div>
  <veda-control data-type="text" property="s-wf:SimpleRouteStartForm_comment" class="-view edit -search"></veda-control>
  <div class="checkbox checkbox_canEdit" style="display:none">
    <label>
      <veda-control property="v-wf:StartForm_canEdit" data-type="boolean"></veda-control>
      <span about="v-wf:StartForm_canEdit" property="rdfs:label"></span>
    </label>
  </div>
</div>
<script>
  $('.sign .checkbox').show();
</script>
  """ ;
.

s-wf:SimpleRouteStartFormForActions_Template
  rdf:type v-ui:ClassTemplate ;
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Шаблон отображения данных для автопоручений"@ru ;
  rdfs:label "Auto instruction start form template"@en ;
  v-ui:template """
<div class="row">
  <div class="col-md-5">
    <em about="v-s:responsible" property="rdfs:label"></em>
    <div rel="v-s:responsible" class="view edit -search" data-template="v-ui:LabelTemplate"></div>
    <veda-control data-type="link" rel="v-s:responsible" class="-view edit search fulltext"></veda-control>
  </div>
  <div class="col-md-4">
    <em about="v-s:description" property="rdfs:label"></em>
    <div property="v-s:description" class="view -edit -search"></div>
    <veda-control data-type="text" property="v-s:description" class="-view edit -search"></veda-control>
  </div>
  <div class="col-md-3">
    <em about="v-s:dateToPlan" property="rdfs:label"></em>
    <div property="v-s:dateToPlan" class="view -edit -search"></div>
    <veda-control data-type="dateTime" property="v-s:dateToPlan" class="-view edit -search"></veda-control>
  </div>
</div>
<hr>
  """ ;
.

s-wf:SimpleRouteStartFormShort_Template
  rdf:type v-ui:ClassTemplate ;
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Шаблон стартовых данных простого маршрута"@ru ;
  rdfs:label "Single route start form template"@en ;
  v-ui:template """
<div>
  <em about="s-wf:SimpleRouteStartForm_participant" property="rdfs:label"></em>
  <div rel="s-wf:SimpleRouteStartForm_participant" class="view edit -search" data-template="v-ui:LabelTemplate"></div>
  <veda-control data-type="link" rel="s-wf:SimpleRouteStartForm_participant" class="-view edit search fulltext"></veda-control>
  <em about="s-wf:SimpleRouteStartForm_comment" property="rdfs:label"></em>
  <div property="s-wf:SimpleRouteStartForm_comment" class="view -edit -search"></div>
  <veda-control data-type="text" property="s-wf:SimpleRouteStartForm_comment" class="-view edit -search"></veda-control>
  <em about="s-wf:SimpleRouteStartForm_deadlineDays" property="rdfs:label"></em>
  <div property="s-wf:SimpleRouteStartForm_deadlineDays" class="view -edit -search"></div>
  <veda-control data-type="integer" property="s-wf:SimpleRouteStartForm_deadlineDays" class="-view edit -search"></veda-control>
  <div class="checkbox checkbox_canEdit -edit">
    <label>
      <veda-control property="v-wf:StartForm_canEdit" data-type="boolean"></veda-control>
      <span about="v-wf:StartForm_canEdit" property="rdfs:label"></span>
    </label>
  </div>
</div>
  """ ;
.

s-wf:SimpleRouteStartFormFull_Template
  rdf:type v-ui:ClassTemplate ;
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Шаблон стартовых данных простого маршрута"@ru ;
  rdfs:label "Single route start form template"@en ;
  v-ui:template """
<div>
  <em about="s-wf:SimpleRouteStartForm_participant" property="rdfs:label"></em>
  <div rel="s-wf:SimpleRouteStartForm_participant" class="view edit -search" data-template="v-ui:LabelTemplate"></div>
  <veda-control data-type="link" rel="s-wf:SimpleRouteStartForm_participant" class="-view edit search fulltext"></veda-control>
  <em about="s-wf:SimpleRouteStartForm_comment" property="rdfs:label"></em>
  <div property="s-wf:SimpleRouteStartForm_comment" class="view -edit -search"></div>
  <veda-control data-type="text" property="s-wf:SimpleRouteStartForm_comment" class="-view edit -search"></veda-control>
  <div class="row">
    <div class="col-md-6">
      <em about="s-wf:SimpleRouteStartForm_deadlineDate" property="rdfs:label"></em>
      <div property="s-wf:SimpleRouteStartForm_deadlineDate" class="view -edit -search"></div>
      <veda-control data-type="dateTime" property="s-wf:SimpleRouteStartForm_deadlineDate" class="-view edit -search"></veda-control>
    </div>
    <div class="col-md-6">
      <em about="s-wf:SimpleRouteStartForm_deadlineDays" property="rdfs:label"></em>
      <div property="s-wf:SimpleRouteStartForm_deadlineDays" class="view -edit -search"></div>
      <veda-control data-type="integer" property="s-wf:SimpleRouteStartForm_deadlineDays" class="-view edit -search"></veda-control>
    </div>
  </div>
  <div class="checkbox checkbox_canEdit -edit">
    <label>
      <veda-control property="v-wf:StartForm_canEdit" data-type="boolean"></veda-control>
      <span about="v-wf:StartForm_canEdit" property="rdfs:label"></span>
    </label>
  </div>
  <div class="checkbox checkbox_setStatus -edit">
    <label>
      <veda-control property="v-wf:StartForm_setStatus" data-type="boolean"></veda-control>
      <span about="v-wf:StartForm_setStatus" property="rdfs:label"></span>
    </label>
  </div>
  <em about="s-wf:SimpleRouteStartForm_controller" property="rdfs:label"></em>
  <div property="s-wf:SimpleRouteStartForm_controller" class="view -edit -search"></div>
  <veda-control data-type="link" rel="s-wf:SimpleRouteStartForm_controller" class="-view edit -search fulltext"></veda-control>
</div>
  """ ;
.

s-wf:controllerSpecification
  rdf:type v-ui:ObjectPropertySpecification ;
  v-ui:forClass s-wf:SimpleRouteStartForm ;
  v-ui:forProperty s-wf:SimpleRouteStartForm_controller ;
  v-ui:maxCardinality 1 ;
  v-ui:queryPrefix "('rdf:type'=='v-s:Appointment' ) && ('v-s:employee.v-s:hasAccount.isExists'=='true') && ('v-s:origin'=='sap hr' || 'v-s:origin'=='Internal' || 'v-s:origin'=='Group' || 'v-s:origin'=='External') || ('rdf:type'=='v-s:Position') && ( 'v-s:origin'=='Role')"^^xsd:string ;
.

s-wf:participantSpecification
  rdf:type v-ui:ObjectPropertySpecification ;
  v-ui:forClass s-wf:SimpleRouteStartForm ;
  v-ui:forProperty s-wf:SimpleRouteStartForm_participant ;
  v-ui:minCardinality 1 ;
  v-ui:maxCardinality 1000 ;
  v-ui:queryPrefix "('rdf:type'=='v-s:Appointment' ) && ('v-s:employee.v-s:hasAccount.isExists'=='true') && ('v-s:origin'=='sap hr' || 'v-s:origin'=='Internal' || 'v-s:origin'=='Group' || 'v-s:origin'=='External') || ('rdf:type'=='v-s:Position') && ( 'v-s:origin'=='Role')"^^xsd:string ;
.

#--------------------------------------------------------------------------------------

s-wf:tr_taken_decision
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rul_transform3_3 ;
  v-wf:transformRule s-wf:rul_transform3_2 ;
  v-wf:transformRule s-wf:rul_transform3_1 ;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:rul_transform3_1
  rdf:type v-wf:Rule ;
  v-wf:segregateElement "contentName('v-wf:takenDecision')" ;
  v-wf:aggregate  "putUri ('rdf:type', 'v-wf:Variable')";
  v-wf:aggregate  "putFieldOfIndividFromElement ('v-wf:variableValue', 'rdf:type')";
  v-wf:aggregate  "putString ('v-wf:variableName', 'result')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_transform3_2
  rdf:type v-wf:Rule ;
  v-wf:segregateElement "contentName('v-wf:takenDecision')" ;
  v-wf:aggregate  "putUri ('rdf:type', 'v-wf:Variable')";
  v-wf:aggregate  "putValue ('v-wf:variableValue')";
  v-wf:aggregate  "putString ('v-wf:variableName', 'result_data')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_transform3_3
  rdf:type v-wf:Rule ;
  v-wf:segregateElement "contentName('v-wf:takenDecision')" ;
  v-wf:aggregate  "putUri ('rdf:type', 'v-wf:Variable')";
  v-wf:aggregate  "putExecutor ('v-wf:variableValue')";
  v-wf:aggregate  "putString ('v-wf:variableName', 'executor')";
  rdfs:isDefinedBy s-wf: ;
.

#--------------------------------------------------------------------------------------

s-wf:tr_sign_form
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rul_transform22_1 ;
  v-wf:transformRule s-wf:rul_transform22_2 ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_transform22_1
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'initiator')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putValue ('v-wf:from')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
.
s-wf:rul_transform22_2
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'docId')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putUri ('rdf:type', 'v-wf:DecisionForm')";
  v-wf:aggregate  "putUri ('rdf:type', 's-wf:UserTaskForm')";
  v-wf:aggregate  "putString ('rdfs:label', 'подписание документа ' + getElement ()[0].data)";
  v-wf:aggregate  "putBoolean ('v-wf:isCompleted', false)";
  v-wf:aggregate  "putValue ('v-wf:onDocument')";
#  v-wf:aggregate  "putExecutor ('v-wf:to')";
  v-wf:aggregate  """
    if ( veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'rdf:type'}], [executor])) === 'v-s:Appointment' ) {
      putUri ('v-wf:to', veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'v-s:employee'}], [executor])));
    } else {
      putExecutor ('v-wf:to');
    }
  """;
  v-wf:aggregate  """
    if ( veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'rdf:type'}], [executor])) === 'v-s:Appointment' ) {
      putUri ('v-wf:to', veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'v-s:occupation'}], [executor])));
    }
  """;
  v-wf:aggregate  "putWorkOrder ('v-wf:onWorkOrder')";
  v-wf:aggregate  "putUri ('v-wf:possibleDecisionClass', 'v-wf:DecisionSign')";
  v-wf:aggregate  "putUri ('v-wf:possibleDecisionClass', 'v-wf:DecisionRemake')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
.

#--------------------------------------------------------------------------------------
s-wf:tr_review_form
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rul_transform23_1 ;
  v-wf:transformRule s-wf:rul_transform23_5 ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_transform23_5
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'docId')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putUri ('rdf:type', 'v-wf:DecisionForm')";
  v-wf:aggregate  "putUri ('rdf:type', 's-wf:UserTaskForm')";
  v-wf:aggregate  "putString ('rdfs:label', 'рассмотрение по документу ' + getElement ()[0].data)";
  v-wf:aggregate  "putBoolean ('v-wf:isCompleted', false)";
  v-wf:aggregate  "putValue ('v-wf:onDocument')";
#  v-wf:aggregate  "putExecutor ('v-wf:to')";
  v-wf:aggregate  """
    if ( veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'rdf:type'}], [executor])) === 'v-s:Appointment' ) {
      putUri ('v-wf:to', veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'v-s:employee'}], [executor])));
    } else {
      putExecutor ('v-wf:to');
    }
  """;
  v-wf:aggregate  """
    if ( veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'rdf:type'}], [executor])) === 'v-s:Appointment' ) {
      putUri ('v-wf:to', veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'v-s:occupation'}], [executor])));
    }
  """;
  v-wf:aggregate  "putWorkOrder ('v-wf:onWorkOrder')";
  v-wf:aggregate  "putUri ('v-wf:possibleDecisionClass', 'v-wf:DecisionReview')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:tr_instruct_form
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rul_transform23_1 ;
  v-wf:transformRule s-wf:rul_transform23_4 ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_transform23_4
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'docId')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putUri ('rdf:type', 'v-wf:DecisionForm')";
  v-wf:aggregate  "putUri ('rdf:type', 's-wf:UserTaskForm')";
  v-wf:aggregate  "putString ('rdfs:label', 'поручение по документу ' + getElement ()[0].data)";
  v-wf:aggregate  "putBoolean ('v-wf:isCompleted', false)";
  v-wf:aggregate  "putValue ('v-wf:onDocument')";
#  v-wf:aggregate  "putExecutor ('v-wf:to')";
  v-wf:aggregate  """
    if ( veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'rdf:type'}], [executor])) === 'v-s:Appointment' ) {
      putUri ('v-wf:to', veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'v-s:employee'}], [executor])));
    } else {
      putExecutor ('v-wf:to');
    }
  """;
  v-wf:aggregate  """
    if ( veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'rdf:type'}], [executor])) === 'v-s:Appointment' ) {
      putUri ('v-wf:to', veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'v-s:occupation'}], [executor])));
    }
  """;
  v-wf:aggregate  "putWorkOrder ('v-wf:onWorkOrder')";
  v-wf:aggregate  "putUri ('v-wf:possibleDecisionClass', 'v-wf:DecisionAchieved')";
  v-wf:aggregate  "putUri ('v-wf:possibleDecisionClass', 'v-wf:DecisionNotPerformed')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:tr_examin_form
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rul_transform23_1 ;
  v-wf:transformRule s-wf:rul_transform23_3 ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_transform23_3
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'docId')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putUri ('rdf:type', 'v-wf:DecisionForm')";
  v-wf:aggregate  "putUri ('rdf:type', 's-wf:UserTaskForm')";
  v-wf:aggregate  "putString ('rdfs:label', 'ознакомление по документу ' + getElement ()[0].data)";
  v-wf:aggregate  "putBoolean ('v-wf:isCompleted', false)";
  v-wf:aggregate  "putValue ('v-wf:onDocument')";
#  v-wf:aggregate  "putExecutor ('v-wf:to')";
  v-wf:aggregate  """
    if ( veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'rdf:type'}], [executor])) === 'v-s:Appointment' ) {
      putUri ('v-wf:to', veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'v-s:employee'}], [executor])));
    } else {
      putExecutor ('v-wf:to');
    }
  """;
  v-wf:aggregate  """
    if ( veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'rdf:type'}], [executor])) === 'v-s:Appointment' ) {
      putUri ('v-wf:to', veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'v-s:occupation'}], [executor])));
    }
  """;
  v-wf:aggregate  "putWorkOrder ('v-wf:onWorkOrder')";
  v-wf:aggregate  "putUri ('v-wf:possibleDecisionClass', 'v-wf:DecisionExamined')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:tr_approv_form
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rul_transform23_1 ;
  v-wf:transformRule s-wf:rul_transform23_2 ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_transform23_1
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'initiator')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putValue ('v-wf:from')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_transform23_2
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'docId')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putUri ('rdf:type', 'v-wf:DecisionForm')";
  v-wf:aggregate  "putUri ('rdf:type', 's-wf:UserTaskForm')";
  v-wf:aggregate  "putString ('rdfs:label', 'утверждение подписанного документа ' + getElement ()[0].data)";
  v-wf:aggregate  "putBoolean ('v-wf:isCompleted', false)";
  v-wf:aggregate  "putValue ('v-wf:onDocument')";
#  v-wf:aggregate  "putExecutor ('v-wf:to')";
  v-wf:aggregate  """
    if ( veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'rdf:type'}], [executor])) === 'v-s:Appointment' ) {
      putUri ('v-wf:to', veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'v-s:employee'}], [executor])));
    } else {
      putExecutor ('v-wf:to');
    }
  """;
  v-wf:aggregate  """
    if ( veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'rdf:type'}], [executor])) === 'v-s:Appointment' ) {
      putUri ('v-wf:to', veda.Util.getUri(veda.Workflow.get_properties_chain(executor, [{$get: 'v-s:occupation'}], [executor])));
    }
  """;
  v-wf:aggregate  "putWorkOrder ('v-wf:onWorkOrder')";
  v-wf:aggregate  "putUri ('v-wf:possibleDecisionClass', 'v-wf:DecisionApprove')";
  v-wf:aggregate  "putUri ('v-wf:possibleDecisionClass', 'v-wf:DecisionRemake')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
.

# ------------------------------------------------------------------------------------------

s-wf:UserTaskForm
  rdf:type owl:Class ;
  rdfs:subClassOf v-wf:DecisionForm ;
  rdfs:label "Форма ответа на задачу"@ru ;
  rdfs:isDefinedBy s-wf: ;
  v-ui:hasTemplate s-wf:UserTaskFormTemplate ;
.

s-wf:UserTaskForm_StartForm_Bundle
  rdf:type v-s:Bundle ;
  rdfs:label "Стартовая форма"@ru ;
  rdfs:label "Start form"@en ;
.
# ------------------------------------------------------------------------------------------

s-wf:UserTaskFormTemplate
  rdf:type v-ui:ClassTemplate ;
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Шаблон для класса Форма ответа на задачу"@ru ;
  v-ui:forClass s-wf:UserTaskForm ;
  v-ui:template """
<script>
  if ( individual.hasValue("v-wf:dateGiven") ) {
    var label = $(".date-given", template);
    var now = new Date();
    var yesterday = new Date().setHours(0,0,0,1);
    var tomorrow = new Date().setHours(23,59,59,999);
    var dateGiven = individual["v-wf:dateGiven"][0];
    var dateGivenYesterday = new Date(dateGiven).setHours(0,0,0,1);
    var dateGivenTomorrow = new Date(dateGiven).setHours(23,59,59,999);
    var dateDone = individual.hasValue("v-wf:takenDecision") && individual["v-wf:takenDecision"][0]["v-s:created"][0];
    if ( individual.hasValue("v-wf:isCompleted", false) ) {
      if (dateGiven < yesterday) {
        label.toggleClass("label-default label-danger");
      } else if (yesterday < dateGiven && dateGiven <= tomorrow) {
        label.toggleClass("label-default label-warning");
      } else if (tomorrow < dateGiven) {
        label.toggleClass("label-default label-success");
      }
    } else {
      if (dateGivenYesterday < dateDone && dateDone <= dateGivenTomorrow) {
        label.toggleClass("label-default label-warning");
      } else if (dateDone < dateGiven) {
        label.toggleClass("label-default label-success");
      } else if (dateGiven < dateDone ) {
        label.toggleClass("label-default label-danger");
      }
    }
  };
  try {
    var isReworkTask = individual["v-wf:onWorkOrder"][0]["v-wf:forWorkItem"][0]["v-wf:forNetElement"][0].id == "s-wf:cr_rework";
    if (isReworkTask) {
      var variableArr = individual["v-wf:onWorkOrder"][0]["v-wf:forWorkItem"][0]["v-wf:forProcess"][0]["v-wf:inVars"];
      var startFormId = variableArr.filter(function(variable){
        return variable["v-wf:variableName"][0] == "startForm_id";
      })[0]["v-wf:variableValue"][0];
      $("#edit-StartForm", template).click(function(){
        var modal = veda.Util.showModal(startFormId, new veda.IndividualModel("s-wf:ComplexRouteStartForm_Common_Template"), "view");
      });
    } else {
      $("#edit-StartForm", template).remove();
    };
  } catch (error) {
    $("#edit-StartForm", template).remove();
    console.log("Unexpected behaviour", error);
  };
//# sourceURL=s-wf:UserTaskFormTemplate_pre
</script>
<div>
  <div class="container sheet">
    <style scoped>
      .taken-decision:empty {
        display:none;
      }
    </style>
    <div class="row">
      <div class="col-xs-7 col-md-9" style="border-right: 1px dotted #ccc;">
        <h2>
          <span about="@" property="rdfs:label"></span><br/>
          <small about="@" property="v-s:description"></small>
        </h2>
        <div class="possible-decisions clearfix" style="position:relative">
          <hr />
          <h4 about="v-wf:takenDecision" property="rdfs:label"></h4>
          <div about="@" rel="v-wf:possibleDecisionClass">
            <div class="radio">
              <label>
                <input type="radio" name="decisionRadios">
                <span property="rdfs:label"></span>
              </label>
            </div>
          </div>
          <div style="position:absolute; bottom:15px; right:0;">
            <button type="button" class="btn btn-primary view -edit -search" id="edit-StartForm" about="s-wf:UserTaskForm_StartForm_Bundle" property="rdfs:label"/>
            <span about="@" data-template="v-ui:StandardButtonsTemplate" data-embedded="true" data-buttons="task"></span>
          </div>
        </div>
        <div class="well new-decision"></div>
        <div class="alert alert-danger hidden" id="show-OverloadNotification">
          <h4>Внимание</h4>
          <span about="v-s:OverloadNotificationMessage" property="rdfs:label"></span>
        </div>
        <div class="well taken-decision" about="@" rel="v-wf:takenDecision"></div>
      </div>
      <div class="col-xs-5 col-md-3">
        <h3><span about="@" property="v-wf:dateGiven" class="date-given label label-default"></span></h3>
        <em about="v-wf:from" property="rdfs:label"></em>
        <div about="@" rel="v-wf:from" data-template="v-ui:LabelTemplate"></div>
        <em about="v-wf:to" property="rdfs:label"></em>
        <div about="@" rel="v-wf:to" data-template="v-ui:LabelTemplate"></div>
        <div about="@" rel="v-wf:redirect_from_task">
          <script>
            if ( !individual.hasValue("v-wf:to") ) {
              template.empty();
            }
          </script>
          <div>
            <hr class="margin-sm"/>
            <em about="v-s:TaskIsRedirectedFrom" property="rdfs:label"> </em>
            <span rel="v-wf:to" data-template="v-ui:LabelTemplate"></span>
            <!--span rel="v-s:creator v-wf:from" data-template="v-ui:LabelTemplate"></span-->
            <div rel="v-wf:takenDecision">
              <em about="rdfs:comment" property="rdfs:label"> </em>
              <span about="@"  property="rdfs:comment"></span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div about="@" class="container sheet view edit -search" data-template="v-ft:TaskRelatedTasksTemplate"></div>
  <div about="@" rel="v-wf:onDocument" class="view edit -search"></div>
</div>
<script>
  $(".possible-decisions input", template).on("change", function (e) {
    var input = $(this);
    var hoder = $(".new-decision", template).empty();
    var decisionClassId = input.closest("[resource]").attr("resource");
    var decisionClass = new veda.IndividualModel( decisionClassId );
    decision["rdf:type"] = [ decisionClass ];
    decision.properties["rdfs:label"] = decisionClass.properties["rdfs:label"];
    decision.present(hoder, undefined, "edit");
  });

  function completedHandler() {
    if ( individual.hasValue("v-wf:isCompleted", true) || individual.hasValue("v-wf:takenDecision") ) {
      $(".possible-decisions, .new-decision", template).remove();
    }
  }
  individual.on("v-wf:isCompleted v-wf:takenDecision", completedHandler);

  // var scriptMainQueue = new veda.IndividualModel('srv:queue-state-scripts_main0');
  // function isOverloadQueue(){
  //   var count = 0;
  //   try {
  //     scriptMainQueue.reset();
  //     var total = scriptMainQueue.properties['srv:total_count'][0].data;
  //     var current = scriptMainQueue.properties['srv:current_count'][0].data;
  //     count = total - current;
  //   } catch (e) {
  //     console.log(e);
  //   }

  //   // console.log('total count: '+ total);
  //   // console.log('current queue: '+ count);
  //   if (count > 1000) {
  //     $('.well.new-decision', template).hide();
  //     $('.action #task-button', template).hide();
  //     $('#show-OverloadNotification').removeClass('hidden');
  //   } else {
  //     $('.well.new-decision', template).show();
  //     $('.action #task-button', template).show();
  //     $('#show-OverloadNotification').addClass('hidden');
  //   }
  // }
  // isOverloadQueue();
  // var intervalId = setInterval(isOverloadQueue, 30000);

  template.one("remove", function () {
    individual.off("v-wf:isCompleted v-wf:takenDecision", completedHandler);
    //clearInterval(intervalId);
  });



  if ( individual.hasValue("v-wf:takenDecision") || !individual.rights.hasValue("v-s:canUpdate", true) ) {
    $(".possible-decisions, .new-decision", template).remove();
  } else {
    var decision = new veda.IndividualModel();
    decision["v-s:backwardTarget"] = [ individual ];
    decision["v-s:backwardProperty"] = [ new veda.IndividualModel("v-wf:takenDecision") ];
    decision["v-s:canRead"] = [ true ];
    $(".possible-decisions input", template).first().prop("checked", "checked").change();
  }
//# sourceURL=s-wf:UserTaskFormTemplate_post
</script>
  """ ;
.

v-wf:DecisionGoSign
  rdf:type owl:Class ;
  rdfs:subClassOf v-wf:Decision ;
  rdfs:label "Перейти к этапу подписания"@ru ;
  rdfs:isDefinedBy s-wf: ;
  v-ui:hasTemplate v-wf:DecisionTemplate1 ;
.

v-wf:DecisionGoApproval
  rdf:type owl:Class ;
  rdfs:subClassOf v-wf:Decision ;
  rdfs:label "Перейти к этапу утверждения"@ru ;
  rdfs:isDefinedBy s-wf: ;
  v-ui:hasTemplate v-wf:DecisionTemplate1 ;
.


#----------------------- Coordination Net ------------------------------

s-wf:tr_actor_add_request_form
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rul_tr_form_1 ;
  v-wf:transformRule s-wf:rul_tr_form_1a ;
  v-wf:transformRule s-wf:rul_tr_form_2 ;
  v-wf:transformRule s-wf:rul_tr_form_6a ;
  v-wf:transformRule s-wf:rul_tr_form_9a ;
  v-wf:transformRule s-wf:rul_tr_form_a ;
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Трансформация создания пользовательской формы дополнительного запроса по задаче"@ru ;
.

s-wf:rul_tr_form_6a
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'possible_decision_for_add_reaction')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putValue ('v-wf:possibleDecisionClass')";
  v-wf:grouping "1";
  rdfs:label "Установить возможные варианты ответов"@ru ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:rul_tr_form_9a
  rdf:type v-wf:Rule ;
  v-wf:segregateObject "objectContentStrValue ('v-wf:variableName', 'actor_task_description')" ;
  v-wf:segregateElement "contentName('v-wf:variableValue')" ;
  v-wf:aggregate  "putValue ('v-s:description')";
  v-wf:grouping "1";
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Установить v-s:description из переменной s-wf:var_actor_task_action"@ru ;
.




# ------------- journal ------------------------

s-wf:var_journal_to
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "v-wf:executor" ;
  rdfs:label "Кому"@ru ;
.

s-wf:var_journal_initiator
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "v-wf:initiator" ;
  rdfs:label "Инициатор"@ru ;
.

s-wf:var_journal_comment
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "rdfs:comment" ;
  rdfs:label "Комментарий"@ru ;
.

s-wf:var_journal_msg
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "rdfs:label" ;
  rdfs:label "Сообщение"@ru ;
.

s-wf:var_journal_decision
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "v-wf:takenDecision" ;
  rdfs:label "Решение"@ru ;
.

s-wf:var_journal_ev_type
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "rdf:type" ;
  rdfs:label "Тип события"@ru ;
.

s-wf:var_journal_doc_id
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "v-s:onDocument" ;
  rdfs:label "Ссылка на документ"@ru ;
.

s-wf:var_journal_process_id
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "v-wf:onProcess" ;
  rdfs:label "Ссылка на процесс"@ru ;
.

s-wf:map_journal_to
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_to ;
  v-wf:mappingExpression "order.getExecutor ()" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_to_4_PLV_actor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_to ;
  v-wf:mappingExpression "process.getLocalVariable ('actor')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_to_4_PLV_controller
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_to ;
  v-wf:mappingExpression "process.getLocalVariable ('controller')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_to_4_PLV_responsible
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_to ;
  v-wf:mappingExpression "process.getLocalVariable ('responsible')?process.getLocalVariable ('responsible'):process.getLocalVariable ('initiator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_to_4_OOV_result_data_N_author
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_to ;
  v-wf:mappingExpression "veda.Workflow.get_properties_chain (order.getOutVariable ('result_data'), [{$get:'v-s:author'}])" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_to_fc
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_to ;
  v-wf:mappingExpression "process.getInputVariable ('financial_controller')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_msg_4_task_label_start
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_msg ;
  v-wf:mappingExpression "task.getLabel ()" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_msg_4_task_label_complete
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_msg ;
  v-wf:mappingExpression "task.getLabel ()" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_initiator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_initiator ;
  v-wf:mappingExpression "process.getInputVariable ('initiator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_process_id
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_process_id ;
  v-wf:mappingExpression "veda.Util.newUri (process.src_data['@'])" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_journal_doc_id
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_journal_doc_id ;
  v-wf:mappingExpression "process.getInputVariable ('docId')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:src_uri
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "src_uri" ;
  rdfs:label "Документ-источник"@ru ;
.

s-wf:name_uri
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "name_uri" ;
  rdfs:label "ID поля"@ru ;
.

s-wf:value
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "value" ;
  rdfs:label "Значение"@ru ;
.

s-wf:map_docID_to_src
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:src_uri ;
  v-wf:mappingExpression "process.getInputVariable ('docId')" ;
  rdfs:isDefinedBy s-wf: ;
.

##########################################################################################################################################

s-wf:var_actor_task
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "actor_task" ;
  rdfs:label "Actor task" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_decision_of_set_responsible_2_actor_task
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task ;
  v-wf:mappingExpression "process.getLocalVariable ('decision_of_set_responsible')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_actor_task_action
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "actor_task_action" ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:label "Var actor task action" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_redirect_from
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "redirect_from" ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:label "Var redirect from" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_actor_task_comment
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "actor_task_comment" ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:label "Var actor task comment" ;
  rdfs:isDefinedBy s-wf: ;
.


s-wf:var_actor_task_description
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "actor_task_description" ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:label "Var actor task description" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_actor_task_comment_4_actor_task
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_comment ;
  v-wf:mappingExpression
  """
  veda.Workflow.get_properties_chain (process.getInputVariable('actor_task'),
              [{$go:'v-s:hasActivity'}, {$get:'v-s:description', $eq:{'v-s:responsible':process.getExecutor ()}}] )
  """;
  rdfs:label "Описание задачи из формы решения пользователя [actor_task]"@ru ;
.

s-wf:map_initiator_4_actor_task
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_initiator ;
  v-wf:mappingExpression """
  veda.Workflow.get_properties_chain (process.getInputVariable('actor_task'),
              [{$go:'v-s:hasActivity'}, {$get:'v-s:author', $eq:{'v-s:responsible':process.getExecutor ()}}]
              )
  """;
  rdfs:label "Описание задачи из формы решения пользователя [actor_task]"@ru ;
.

s-wf:map_actor_task_date_to_4_actor_task
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_date_to ;
  v-wf:mappingExpression """
  veda.Workflow.get_properties_chain (process.getInputVariable('actor_task'),
              [{$go:'v-s:hasActivity'}, {$get:'v-s:dateTo', $eq:{'v-s:responsible':process.getExecutor ()}}] )
  """;
  rdfs:label "Описание задачи из формы решения пользователя [actor_task]"@ru ;
.

s-wf:map_actor_task_description_from_LV_result_decision
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_description ;
  v-wf:mappingExpression "veda.Workflow.get_properties_chain (process.getLocalVariable('result_decision'), [{$get:'rdfs:comment'}] )";
  rdfs:label "Описание задачи из формы решения пользователя [result_decision]"@ru ;
.

s-wf:map_actor_task_action_4LV_result_decision
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_action ;
  v-wf:mappingExpression """
  veda.Workflow.get_properties_chain (process.getLocalVariable('result_decision'),
                            [{$go:'rdf:type'}, {$get:'rdfs:label'}] )
  """;
  rdfs:label "Описание задачи из формы решения пользователя [result_decision]"@ru ;
.

s-wf:map_actor_task_action_4LV_result_decision_nct2
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_action ;
  v-wf:mappingExpression """
  veda.Workflow.get_properties_chain (process.getLocalVariable('result_decision_nct2'),
                            [{$go:'rdf:type'}, {$get:'rdfs:label'}] )
  """;
  rdfs:label "Описание задачи из формы решения пользователя [result_decision_nct2]"@ru ;
.

s-wf:map_actor_task_action_return_result_decision
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_action ;
  v-wf:mappingExpression """
  veda.Workflow.get_properties_chain (task_result.getValue ('result_data'),
                            [{$go:'rdf:type'}, {$get:'rdfs:label'}] )
  """;
  rdfs:label "Описание задачи из формы решения пользователя [result_decision]"@ru ;
.


s-wf:var_actor_task_date_to
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "actor_task_date_to" ;
  rdfs:label "Actor_task_date_to" ;
  v-wf:varDefineScope v-wf:Net ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_task_date_to_2_actor_task
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_date_to ;
  v-wf:mappingExpression """

  veda.Workflow.get_properties_chain (process.getInputVariable('actor_task'),
              [{$go:'v-s:hasActivity'}, {$get:'v-s:dateTo', $eq:{'v-s:responsible':process.getExecutor ()}}]
              )

  """;
  rdfs:label "Описание задачи из формы решения пользователя"@ru ;
.

s-wf:map_PI_actor_task_4_actor_task
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task ;
  v-wf:mappingExpression "process.getInputVariable ('actor_task')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_PI_actor_task_date_to_4_actor_task_date_to
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_date_to ;
  v-wf:mappingExpression
    """
    if (process.getInputVariable ('actor_task_add_to_date_to'))
        veda.Util.newDate (addDay (veda.Util.getFirstValue (process.getInputVariable ('actor_task_date_to')), veda.Util.getFirstValue (process.getInputVariable ('actor_task_add_to_date_to'))));
    else
        process.getInputVariable ('actor_task_date_to');
    """;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_PI_actor_task_action_4_actor_task_action
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_action ;
  v-wf:mappingExpression "process.getInputVariable ('actor_task_action')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_PI_actor_task_comment_4_actor_task_comment
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_comment ;
  v-wf:mappingExpression "process.getInputVariable ('actor_task_comment')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_actor_2_result_decision
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor ;
  v-wf:mappingExpression """

  veda.Workflow.get_properties_chain (process.getLocalVariable('result_decision'),
              [{$get:'v-wf:to'}]
             )

  """;
  rdfs:label "Исполнитель из формы решения пользователя"@ru ;
.

s-wf:map_responsible_2_result_decision
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_responsible ;
  v-wf:mappingExpression """

  veda.Workflow.get_properties_chain (process.getLocalVariable('result_decision'),
              [{$get:'v-wf:to'}]
             )

  """;
  rdfs:label "Исполнитель из формы решения пользователя"@ru ;
.

s-wf:map_controller_2_result_decision
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_controller ;
  v-wf:mappingExpression """

  veda.Workflow.get_properties_chain (process.getLocalVariable('result_decision'),
              [{$get:'v-wf:to'}]
             )

  """;
  rdfs:label "Исполнитель из формы решения пользователя"@ru ;
.

s-wf:map_redirect_from_2_result_decision
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_redirect_from ;
  v-wf:mappingExpression """

  veda.Workflow.get_properties_chain (process.getLocalVariable('result_decision'),
              [{$get:'v-s:backwardTarget'}] )

  """;
  rdfs:label "Задача из формы решения пользователя"@ru ;
.

s-wf:map_from_2_result_decision_author
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_from ;
  v-wf:mappingExpression """
  veda.Workflow.get_properties_chain(process.getLocalVariable('redirect_from'), [{$get:'v-wf:from'}]).length > 0  ? veda.Workflow.get_properties_chain(process.getLocalVariable('redirect_from'), [{$go:'v-wf:from'}, {$get:'v-s:defaultAppointment'}]) : veda.Workflow.get_properties_chain(process.getLocalVariable('result_decision'), [{$get:'v-s:creator'}])
  """;
  rdfs:label "Автор задачи из формы решения пользователя"@ru ;
.

s-wf:map_from_sys_appt
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_from ;
  v-wf:mappingExpression "veda.Util.newUri ('cfg:VedaSystemAppointment')";
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Автор задачи - система"@ru ;
.

s-wf:map_wf_from_sys_appt
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_wf_from ;
  v-wf:mappingExpression "newUri ('cfg:VedaSystemAppointment')";
  rdfs:isDefinedBy s-wf: ;
  rdfs:label "Автор письма - система"@ru ;
.

s-wf:map_redirect_from_2_undefine
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_redirect_from ;
  v-wf:mappingExpression "veda.Util.newUri ('s-wf:EmptyTask')";
  rdfs:label "redirect_from = undefine" ;
.

s-wf:map_result_decision_dateTo_2_actor_task_date_to
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_date_to  ;
  v-wf:mappingExpression """

  veda.Workflow.get_properties_chain (process.getLocalVariable('result_decision'),
              [{$get:'v-s:dateTo'}])

  """;
  rdfs:label "Новая дата срока задачи из формы решения пользователя Доработать"@ru ;
.
##########################################################################################################################################


s-wf:transformation_uri
  rdf:type v-wf:VarDefine ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:varDefineName "transformation_uri" ;
  rdfs:label "Ссылка на трансформацию"@ru ;
.

s-wf:def_exec_actor
  rdf:type v-wf:ExecutorDefinition ;
  v-wf:executorExpression "process.getLocalVariable ('actor')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:def_exec_controller
  rdf:type v-wf:ExecutorDefinition ;
  v-wf:executorExpression "process.getLocalVariable ('controller')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:def_exec_initiator
  rdf:type v-wf:ExecutorDefinition ;
  v-wf:executorExpression "process.getInputVariable ('initiator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:def_exec_responsible
  rdf:type v-wf:ExecutorDefinition ;
  v-wf:executorExpression "process.getLocalVariable ('responsible') ? process.getLocalVariable ('responsible') : (process.getLocalVariable ('controller') ? process.getLocalVariable ('controller') : process.getLocalVariable ('initiator'))" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_set_if_result
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_result ;
  v-wf:mappingExpression "task_result.if_all_executors_taken_decision('v-wf:DecisionAgreed', 'v-wf:DecisionRemake')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_set_result_decision_from_TR_result_data
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_result_decision ;
  v-wf:mappingExpression "task_result.getValue ('result_data')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_set_result_decision_nct2_from_TR_result_data
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_result_decision_nct2 ;
  v-wf:mappingExpression "task_result.getValue ('result_data')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_set_actor_task_description_from_TR_result_data
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_description ;
  v-wf:mappingExpression "veda.Workflow.get_properties_chain (task_result.getValue ('result_data'), [{$get:'rdfs:comment'}])";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_set_actor_from_executor_or_PI_actor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor ;
  v-wf:mappingExpression
    """
        if (process.getInputVariable ('actor'))
            process.getInputVariable ('actor');
        else
            process.getExecutor ();
    """;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_set_actor_from_executor_or_PI_controller
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_controller ;
  v-wf:mappingExpression
    """
        process.getInputVariable ('controller');
    """;
  rdfs:isDefinedBy s-wf: ;
.


s-wf:map_set_add_request_actor_from_initiator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_add_request_actor ;
  v-wf:mappingExpression "process.getInputVariable ('initiator')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_jrn_msg_nc_t2_b
  rdf:type v-wf:Mapping ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mapToVariable s-wf:var_journal_msg ;
  v-wf:mappingExpression "veda.Util.newStr (process.getLocalVariable ('actor_task_action')[0].data)" ;
.

s-wf:map_jrn_msg_nc_t2_b_remake
  rdf:type v-wf:Mapping ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mapToVariable s-wf:var_journal_msg ;
  v-wf:mappingExpression "veda.Util.newStr ('Доработать')" ;
.

s-wf:map_jrn_msg_nc_t2_b_ev
  rdf:type v-wf:Mapping ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mapToVariable s-wf:var_journal_ev_type ;
  v-wf:mappingExpression "veda.Util.newUri ('v-wf:TaskGiven')" ;
.

s-wf:map_jrn_msg_nc_t2_comment
  rdf:type v-wf:Mapping ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mapToVariable s-wf:var_journal_comment ;
  v-wf:mappingExpression "process.getLocalVariable ('actor_task_comment')" ;
.

s-wf:map_jrn_msg_nce_t2_b
  rdf:type v-wf:Mapping ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mapToVariable s-wf:var_journal_msg ;
  v-wf:mappingExpression "veda.Util.newStr ('Получен ответ на задачу')" ;
.

s-wf:map_jrn_msg_nce_t2_b_ev
  rdf:type v-wf:Mapping ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mapToVariable s-wf:var_journal_ev_type ;
  v-wf:mappingExpression "veda.Util.newUri ('v-wf:TaskCompleted')" ;
.

s-wf:map_jrn_decision_b
  rdf:type v-wf:Mapping ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mapToVariable s-wf:var_journal_decision ;
  v-wf:mappingExpression "order.getOutVariable ('result_data')" ;
.

s-wf:c1
  v-wf:hasFlow s-wf:nc_f_c1_set_status_start;
  a v-wf:Condition;
  rdfs:label "C1"@ru;
  v-wf:predicate "true"^^xsd:string;
  v-s:author cfg:AdministratorAppointment;
  v-s:created "2015-11-09T12:51:20.000Z"^^xsd:dateTime;
  v-wf:locationX "271"^^xsd:integer;
  v-wf:locationY "543"^^xsd:integer;
  rdfs:isDefinedBy <http://semantic-machines.com/veda/simple-workflow-base/>.

d:abaa42215-965f-a032-aada-31be82a54e95 a v-wf:Flow;
  v-s:author cfg:AdministratorAppointment;
  v-wf:predicate "true"^^xsd:string;
  v-s:created "2015-11-09T12:51:20.156Z"^^xsd:dateTime;
  v-wf:flowsInto s-wf:nc_t1.

d:a65787936-f51e-a83c-f537-95eaaa02c21a
  a v-wf:Flow;
  v-s:author cfg:AdministratorAppointment;
  v-s:created "2015-11-09T12:51:20.163Z"^^xsd:dateTime;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', task.getInputVariable ('decision_route_to_add_reaction')) == true"^^xsd:string;
  v-wf:flowsInto s-wf:additional_user_response.

d:afdd3ebd0-7934-8d38-1f68-158a05f0330d a v-wf:Flow;
  v-s:author cfg:AdministratorAppointment;
  v-s:created "2015-11-09T12:51:20.166Z"^^xsd:dateTime;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionBreak')) == false && task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionAchieved')) == false"^^xsd:string;
  v-wf:flowsInto s-wf:c1.

d:ac2ce1732-d914-c4f9-f4b6-2064864b3f23 a v-wf:Flow;
  v-s:author cfg:AdministratorAppointment;
  v-s:created "2015-11-09T14:25:56.755Z"^^xsd:dateTime;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionBreak')) == true"^^xsd:string;
  v-wf:flowsInto s-wf:set_status_finish.

s-wf:map_set_result_from_local
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_result ;
  v-wf:mappingExpression "process.getLocalVariable ('result')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_last_actor_4_PLV_actor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_last_actor ;
  v-wf:mappingExpression "process.getLocalVariable ('actor')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:m_result_f_out_var
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_result ;
  v-wf:mappingExpression "task.getOutVariable ('result')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_set_result_decision_from_local
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_result_decision ;
  v-wf:mappingExpression "process.getLocalVariable ('result_decision')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_now_plus_30_4_actor_task_date_to
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_date_to ;
  v-wf:mappingExpression "veda.Util.newDate (addDay (new Date (), 30))";
  rdfs:isDefinedBy s-wf: ;
.

d:aec10d9da-789d-fd65-a094-bd4ed7b14822 a v-wf:Flow;
  v-s:author cfg:AdministratorAppointment;
  v-s:created "2015-11-17T11:54:51.991Z"^^xsd:dateTime;
  v-wf:predicate "process.getInputVariable ('actor_task') != undefined"^^xsd:string;
  v-wf:flowsInto d:a16bb1fd3-64eb-a7bb-501d-889b2aa4500d.

s-wf:nc_f_t3_t1 a v-wf:Flow;
  rdfs:isDefinedBy s-wf: ;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:predicate "process.getInputVariable ('actor_task') == undefined"^^xsd:string;
  v-wf:flowsInto s-wf:c1;
.



s-wf:nc_r_to_i_return a v-wf:Flow;
  rdfs:isDefinedBy s-wf:;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionRemake')) == true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto s-wf:nc_t2;
.

s-wf:nc_r_to_i_finish a v-wf:Flow;
  rdfs:isDefinedBy s-wf:;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionAcceptMotivatedRefusal')) == true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto s-wf:c2;
.

s-wf:nc_r_to_aur a v-wf:Flow;
  rdfs:isDefinedBy s-wf:;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionRedirect')) == true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto d:abc5142af-b501-1ec6-8ee0-acb767f078a4_rti;
.

s-wf:nc_to_finish a v-wf:Flow;
  rdfs:isDefinedBy s-wf:;
  v-wf:predicate "(!process.getInputVariable ('controller')) || task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionConfirm')) == true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto s-wf:set_status_finish;
.

s-wf:nc_to_aur a v-wf:Flow;
  rdfs:isDefinedBy s-wf:;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionRedirect')) == true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto d:abc5142af-b501-1ec6-8ee0-acb767f078a4_oc;
.

s-wf:nc_t2_to_r a v-wf:Flow;
  rdfs:isDefinedBy s-wf:;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionRejected')) == true || task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionNotPerformed')) == true || task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionNotForMe')) == true || task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionProlongate')) == true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto s-wf:nc_return_to_initiator;
.

s-wf:nc_f_t2_c2 a v-wf:Flow;
  rdfs:isDefinedBy s-wf:;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionRevokeTask')) == true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto s-wf:c2;
.

s-wf:map_t2_sm1
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_date_to ;
  v-wf:mappingExpression "process.getLocalVariable ('actor_task_date_to')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_t2_sm2
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_action ;
  v-wf:mappingExpression "process.getLocalVariable ('actor_task_action')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_t2_sm3
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_comment ;
  v-wf:mappingExpression "process.getLocalVariable ('actor_task_comment')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_t2_sm_control
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_comment ;
  v-wf:mappingExpression "veda.Util.newStr(getFirstValue(process.getLocalVariable ('actor_task_comment')) || '')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_t2_sm5
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_actor_task_comment ;
  v-wf:mappingExpression "veda.Workflow.get_properties_chain (task_result.getValue ('result_data'), [{$get:'rdfs:comment'}])";
  rdfs:isDefinedBy s-wf: ;
.


s-wf:nc_finish a v-wf:OutputCondition;
  v-wf:locationX "1406"^^xsd:integer;
  v-wf:locationY "423"^^xsd:integer;
  rdfs:label "C2c"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  rdfs:isDefinedBy <http://semantic-machines.com/veda/simple-workflow/>.

s-wf:nc_f_ic_t1 a v-wf:Flow;
  rdfs:isDefinedBy s-wf: ;
  v-wf:predicate "true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto s-wf:nc_t3.

s-wf:nc_f_c1_set_status_start a v-wf:Flow;
  rdfs:isDefinedBy s-wf: ;
  v-wf:predicate "true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto s-wf:set_status_start.

s-wf:nc_f_t1_t2 a v-wf:Flow;
  rdfs:isDefinedBy s-wf: ;
  v-wf:predicate "true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto s-wf:nc_t2.

s-wf:nc_f_t1_oc a v-wf:Flow;
  rdfs:isDefinedBy s-wf: ;
  v-wf:predicate "true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto s-wf:nc_oc.

s-wf:nc_f_t1_rti a v-wf:Flow;
  rdfs:isDefinedBy s-wf: ;
  v-wf:predicate "true"^^xsd:string;
  v-wf:belongsTo s-wf:net_coordination;
  v-wf:flowsInto s-wf:nc_return_to_initiator.

s-wf:nc_f_t2_oc a v-wf:Flow;
  rdfs:isDefinedBy s-wf: ;
  v-wf:flowsInto s-wf:nc_oc_rights;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionRedirect')) == false && task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionRejected')) == false && task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionNotPerformed')) == false && task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionNotForMe')) == false && task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionProlongate')) == false && task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionRevokeTask')) == false && task_result.is_all_executors_taken_decision ('result', task.getInputVariable ('decision_route_to_add_reaction')) == false"^^xsd:string.

s-wf:nc_f_t2_t1 a v-wf:Flow;
  v-wf:predicate "task_result.is_all_executors_taken_decision ('result', veda.Util.newUri ('v-wf:DecisionRedirect')) == true"^^xsd:string;
  v-wf:flowsInto d:abc5142af-b501-1ec6-8ee0-acb767f078a4;
  rdfs:isDefinedBy <http://semantic-machines.com/veda/simple-workflow-base/>.

d:a2dcf4fb5-ca60-4b2d-d303-91f8c29db59e a v-wf:Flow;
  v-s:author cfg:AdministratorAppointment;
  v-wf:predicate "true"^^xsd:string;
  v-s:created "2015-11-10T18:08:39.178Z"^^xsd:dateTime;
  v-wf:flowsInto s-wf:nc_t1.

d:a2dcf4fb5-ca60-4b2d-d303-91f8c29db59e_oc a v-wf:Flow;
  v-s:author cfg:AdministratorAppointment;
  v-wf:predicate "true"^^xsd:string;
  v-s:created "2015-11-10T18:08:39.178Z"^^xsd:dateTime;
  v-wf:flowsInto s-wf:nc_oc_rights.

d:a2dcf4fb5-ca60-4b2d-d303-91f8c29db59e_rti a v-wf:Flow;
  v-s:author cfg:AdministratorAppointment;
  v-wf:predicate "true"^^xsd:string;
  v-s:created "2015-11-10T18:08:39.178Z"^^xsd:dateTime;
  v-wf:flowsInto s-wf:nc_rti_rights.


d:a8b89a22d-23b9-1c1c-c5dc-3443fd3972de a v-wf:Flow;
  v-s:author cfg:AdministratorAppointment;
  v-s:created "2015-11-17T11:54:51.993Z"^^xsd:dateTime;
  v-wf:predicate  "true";
  v-wf:flowsInto s-wf:c1.

s-wf:c2 a v-wf:Condition;
  v-wf:hasFlow d:a6caa3c11-9333-4270-549f-e899df057223;
  v-s:author cfg:AdministratorAppointment;
  v-s:created "2015-11-25T09:21:02.217Z"^^xsd:dateTime;
  rdfs:label "C2"^^xsd:string;
  v-wf:locationX "1255"^^xsd:integer;
  v-wf:locationY "549"^^xsd:integer.

d:a6caa3c11-9333-4270-549f-e899df057223 a v-wf:Flow;
  v-s:author cfg:AdministratorAppointment;
  v-wf:predicate "true"^^xsd:string;
  v-s:created "2015-11-25T09:21:02.222Z"^^xsd:dateTime;
  v-wf:flowsInto s-wf:set_status_finish.


#---- ---- -----

s-wf:ss1 a v-s:SavedSearch;
  rdfs:isDefinedBy s-wf: ;
  v-s:author td:RomanKarpov;
  v-s:query "'rdfs:isDefinedBy' == 's-wf:'"^^xsd:string;
  rdfs:label "Базовая онтология маршрутов монди"^^xsd:string;
  v-s:created "2015-05-23T13:27:18.000Z"^^xsd:dateTime.



# ----------- define vars for message template -------
s-wf:map_msg_template_4_SV_default_template
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_msg_template ;
  v-wf:mappingExpression "process.getInputVariable('$template') ? process.getInputVariable('$template') : veda.Util.newUri('s-wf:msg-template-universal')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_msg_template_4_SV_default_template_notification
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_msg_template ;
  v-wf:mappingExpression "process.getInputVariable('$template') ? process.getInputVariable('$template') : veda.Util.newUri('s-wf:msg-template-universal_notification')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_from_4_TIV_initiator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_from ;
  v-wf:mappingExpression "task.getInputVariable ('initiator')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_from_4_TIV_from
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_from ;
  v-wf:mappingExpression "task.getInputVariable ('from')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_wf_from_4_TIV_sys_appt
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_wf_from ;
  v-wf:mappingExpression "veda.Util.newUri ('cfg:VedaSystemAppointment')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_wf_from_4_TIV_initiator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_wf_from ;
  v-wf:mappingExpression "task.getInputVariable ('from')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_document_4_TIV_docId
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_document ;
  v-wf:mappingExpression "task.getInputVariable ('docId')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_comment_4_TIV_actor_task_action
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_task ;
  v-wf:mappingExpression "task.getInputVariable ('actor_task_action')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_comment_4_TIV_actor_task_rework
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_task ;
  v-wf:mappingExpression "veda.Util.newStr('Доработать')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_comment_4_TIV_actor_task_comment
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_comment ;
  v-wf:mappingExpression "task.getInputVariable ('actor_task_comment')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_rdf_type_4_TIV_documentType
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_rdf_type ;
  v-wf:mappingExpression "task.getInputVariable ('documentType')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_documentType_4_TIV_documentType
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_documentType ;
  v-wf:mappingExpression "process.getLocalVariable ('documentType')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_inbox_url_4_vedaInfo_appInboxUrl
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_inbox_url ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mappingExpression
  """
  veda.Workflow.get_properties_chain (veda.Util.newUri ('v-s:vedaInfo'),[{$get:'v-wf:appInboxUrl'}])
  """;
.
s-wf:map_inbox_url_4_appInboxUrl_of_to
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_inbox_url ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mappingExpression
  """
  veda.Util.newStr ( veda.Workflow.getInboxUrl(task.getInputVariable ('to')) )
  """;
.
s-wf:map_inbox_url_4_appInboxUrl_of_initiator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_inbox_url ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mappingExpression
  """
  veda.Util.newStr ( veda.Workflow.getInboxUrl(process.getInputVariable ('initiator')) )
  """;
.
s-wf:map_inbox_url_4_appInboxUrl_of_executor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_inbox_url ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mappingExpression
  """
  veda.Util.newStr ( veda.Workflow.getInboxUrl(order.getExecutor()) )
  """;
.

s-wf:map_doc_url_4_vedaInfo_appUrl
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_document_url ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mappingExpression
  """
  veda.Util.newStr (getFirstValue (veda.Workflow.get_properties_chain (veda.Util.newUri ('v-s:vedaInfo'), [{$get:'v-s:appUrl'}])) + "/" + veda.Util.getFirstValue(task.getInputVariable ('docId')))
  """;
.

s-wf:map_doc_url_4_appUrl_of_to
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_document_url ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mappingExpression
  """
  veda.Util.newStr ( veda.Workflow.getSystemUrl(task.getInputVariable('to')) + "/" + veda.Util.getFirstValue(task.getInputVariable ('docId')) )
  """;
.

s-wf:map_doc_url_4_appUrl_of_initiator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_document_url ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mappingExpression
  """
  veda.Util.newStr ( veda.Workflow.getSystemUrl(process.getInputVariable('initiator')) + "/" + veda.Util.getFirstValue(task.getInputVariable ('docId')) )
  """;
.

s-wf:map_doc_url_4_appUrl_of_executor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_document_url ;
  rdfs:isDefinedBy s-wf: ;
  v-wf:mappingExpression
  """
  veda.Util.newStr ( veda.Workflow.getSystemUrl(order.getExecutor()) + "/" + veda.Util.getFirstValue(task.getInputVariable ('docId')) )
  """;
.

s-wf:map_var_wf_to_task_to
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_wf_to ;
  v-wf:mappingExpression "task.getInputVariable ('to')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_var_to_task_to
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_to ;
  v-wf:mappingExpression "task.getInputVariable ('to')";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_msg_executor_informing
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_wf_to ;
  v-wf:mappingExpression "order.getExecutor ()";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_vf_to_4_O_executor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_wf_to ;
  v-wf:mappingExpression "order.getExecutor ()";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_vf_to_4_0_initiator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_wf_to ;
  v-wf:mappingExpression "process.getInputVariable ('initiator')" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_to_4_O_executor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_to ;
  v-wf:mappingExpression "order.getExecutor ()";
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_task_url_4_O_DecisionForms
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_task_url;
  v-wf:mappingExpression
  """
  veda.Util.newStr (getFirstValue (veda.Workflow.get_properties_chain (veda.Util.newUri ('v-s:vedaInfo'), [{$get:'v-s:appUrl'}])) + "/" + veda.Util.getFirstValue(order.getDecisionForms ()))
  """;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_task_url_4_O_DecisionForms_of_to
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_task_url;
  v-wf:mappingExpression
  """
  veda.Util.newStr ( veda.Workflow.getSystemUrl(task.getInputVariable('to')) + "/" + veda.Util.getFirstValue(order.getDecisionForms()) )
  """;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:map_task_url_4_O_DecisionForms_of_initiator
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_task_url;
  v-wf:mappingExpression
  """
  veda.Util.newStr ( veda.Workflow.getSystemUrl(process.getInputVariable('initiator')) + "/" + veda.Util.getFirstValue(order.getDecisionForms()) )
  """;
  rdfs:isDefinedBy s-wf: ;
.
s-wf:map_task_url_4_O_DecisionForms_of_executor
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_task_url;
  v-wf:mappingExpression
  """
  veda.Util.newStr ( veda.Workflow.getSystemUrl(order.getExecutor()) + "/" + veda.Util.getFirstValue(order.getDecisionForms()) )
  """;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_rdf_type_4_v_s_Email
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:var_rdf_type ;
  v-wf:mappingExpression "veda.Util.newUri ('v-s:Email')";
  rdfs:isDefinedBy s-wf: ;
.

# # # # # # # # # # # # # # # # # # #

s-wf:var_msg_template
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "$template" ;
  rdfs:label "Var $template" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_document
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "document" ;
  rdfs:label "Var document" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_rdf_type
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "rdf:type" ;
  rdfs:label "Var rdf:type" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_from
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "from" ;
  rdfs:label "Var from" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_to
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "to" ;
  rdfs:label "Var to" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_wf_to
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "v-wf:to" ;
  rdfs:label "Var v-wf:to" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_wf_from
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "v-wf:from" ;
  rdfs:label "Var v-wf:from" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_comment
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "comment" ;
  rdfs:label "Var comment" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_document_url
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "document_url" ;
  rdfs:label "Var document_url" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_task_url
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "task_url" ;
  rdfs:label "Var task_url" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_task
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "task" ;
  rdfs:label "Var task" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:var_inbox_url
  rdf:type v-wf:VarDefine ;
  v-wf:varDefineName "inbox_url" ;
  rdfs:label "Var inbox_url" ;
  rdfs:isDefinedBy s-wf: ;
.

s-wf:map_currentNetToIsProcess_to_transformation
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:transformation_uri ;
  v-wf:mappingExpression "veda.Util.newUri('s-wf:currentNetToIsProcess')" ;
  rdfs:label "добавление id процесса в поле документа"@ru ;
.

s-wf:currentNetToIsProcess
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rule1currentNetToIsProcess ;
  v-wf:transformRule s-wf:rule2currentNetToIsProcess ;
.
s-wf:rule1currentNetToIsProcess
  rdf:type v-wf:Rule ;
  v-wf:aggregate "putElement ()" ;
  v-wf:grouping "@", "1";
.
s-wf:rule2currentNetToIsProcess
  rdf:type v-wf:Rule ;
  v-wf:segregateElement "contentName('@')" ;
  v-wf:aggregate  "putThisProcess ('v-wf:isProcess')";
  v-wf:grouping "@", "1";
.

s-wf:map_currentNetFromIsProcess_to_transformation
  rdf:type v-wf:Mapping ;
  v-wf:mapToVariable s-wf:transformation_uri ;
  v-wf:mappingExpression "veda.Util.newUri('s-wf:currentNetFromIsProcess')" ;
  rdfs:label "удаление id процесса из поля документа"@ru ;
.
s-wf:currentNetFromIsProcess
  rdf:type v-wf:Transform ;
  v-wf:transformRule s-wf:rule1currentNetFromIsProcess ;
  v-wf:transformRule s-wf:rule2currentNetFromIsProcess ;
.
s-wf:rule1currentNetFromIsProcess
  rdf:type v-wf:Rule ;
  v-wf:aggregate "putElement ()" ;
  v-wf:grouping "@", "1";
.
s-wf:rule2currentNetFromIsProcess
  rdf:type v-wf:Rule ;
  v-wf:segregateElement "contentName('@')" ;
  v-wf:aggregate  "removeThisProcess ('v-wf:isProcess')";
  v-wf:grouping "@", "1";
.

# Шаблоны e-mail уведомлений

s-wf:msg-template-universal-notification_processStart
  rdf:type v-s:Notification ;
  v-s:hasMessageType v-s:ProcessStartNotification ;
  v-s:notificationLanguage v-ui:RU ;
  v-s:notificationSubject "{{app_name}}. Уведомление: запущен процесс по документу '{{documentType}}: {{document}}'" ;
  v-s:notificationBody
  """Уважаемый пользователь, {{to}}

Запущен процесс по документу '{{documentType}}: {{document}}'
{{document_url}}

Это сообщение сформировано автоматически. Отвечать на него не нужно.
Система {{app_name}}
""" ;
.
s-wf:msg-template-universal-notification_processEnd
  rdf:type v-s:Notification ;
  v-s:hasMessageType v-s:ProcessFinishNotification ;
  v-s:notificationLanguage v-ui:RU ;
  v-s:notificationSubject "{{app_name}}. Уведомление: завершен процесс по документу '{{documentType}}: {{document}}'" ;
  v-s:notificationBody
  """Уважаемый пользователь: {{to}}

Завершен процесс по документу '{{documentType}}: {{document}}'
{{document_url}}

Это сообщение сформировано автоматически. Отвечать на него не нужно.
Система {{app_name}}
""" ;
.

s-wf:msg-template-universal
  rdf:type v-s:Notification ;
  v-s:hasMessageType v-s:TaskReceivedNotification ;
  v-s:notificationLanguage v-ui:RU ;
  v-s:notificationSubject "{{app_name}}. Задача: '{{task}}' по документу '{{documentType}}: {{document}}'" ;
  v-s:notificationBody
  """Уважаемый пользователь, {{to}}

Вы получили задачу '{{task}}', {{comment}}
По документу '{{documentType}}: {{document}}'

Задачу направил {{from}}

Пожалуйста, используйте ссылки для перехода на нужные страницы:
* Документ: {{document_url}}
* Задача: {{task_url}}
* Все входящие задачи: {{inbox_url}}

Это сообщение сформировано автоматически. Отвечать на него не нужно.
Система {{app_name}}
""" ;
.

s-wf:msg-template-universal-notification
  rdf:type v-s:Notification ;
  v-s:hasMessageType v-s:OtherNotification ;
  v-s:notificationLanguage v-ui:RU ;
  v-s:notificationSubject "{{app_name}}. Уведомление: предоставлен доступ к документу '{{documentType}}: {{document}}'" ;
  v-s:notificationBody
  """Уважаемый пользователь, {{to}}

Вам был предоставлен доступ к документу {{documentType}}: {{document}}
{{document_url}}

Доступ предоставил {{from}}

Это сообщение сформировано автоматически. Отвечать на него не нужно.
Система {{app_name}}
""" ;
.

s-wf:msg-template-project
  rdf:type v-s:Notification ;
  v-s:hasMessageType v-s:TaskReceivedNotification ;
  v-s:notificationLanguage v-ui:RU ;
  v-s:notificationSubject "{{app_name}}. Задача: рассмотреть документ '{{documentType}}: {{document}}'" ;
  v-s:notificationBody
  """Уважаемый пользователь, {{to}}

Вы получили на рассмотрение предложение по повышению эффективности работы нашей компании.

Задачу направил {{from}}

Пожалуйста, оцените его эффективность и примите решение по реализации.

Помните, что в приоритете те предложения, которые:
* Направлены на повышение качества выпускаемой продукции
* Приведут к сокращению себестоимости выпускаемой продукции
* Направлены на повышение уровня безопасности и улучшение условий труда
* Могут быть реализованы с небольшими затратами
* Применимы в других подразделениях, на аналогичном оборудовании или операциях
* Оригинальны и просты
* Могут быть реализованы собственными силами

Используйте ссылки для перехода на нужные страницы:
* Документ: {{document_url}}
* Задача: {{task_url}}
* Все входящие задачи: {{inbox_url}}

На принятие решения по поступившему предложению у Вас есть 30 дней.

Это сообщение сформировано автоматически. Отвечать на него не нужно.
Система {{app_name}}
""" ;
.

s-wf:msg-template-meeting-approval
  rdf:type v-s:Notification ;
  v-s:hasMessageType v-s:TaskReceivedNotification ;
  v-s:notificationLanguage v-ui:RU ;
  v-s:notificationSubject "{{app_name}}. Задача: утвердить документ '{{documentType}}: {{document}}'" ;
  v-s:notificationBody
  """Уважаемый пользователь, {{to}}

Вы получили на утверждение документ '{{documentType}}: {{document}}'
Вы имеете возможность редактировать документ. После утверждения система сделает автоматическую рассылку отчета о встрече исполнителям.

Задачу направил {{from}}

Используйте ссылки для перехода на нужные страницы:
* Документ: {{document_url}}
* Задача: {{task_url}}
* Все входящие задачи: {{inbox_url}}

Это сообщение сформировано автоматически. Отвечать на него не нужно.
Система {{app_name}}
""" ;
.

s-wf:msg-template-meeting-distribution
  rdf:type v-s:Notification ;
  v-s:hasMessageType v-s:TaskReceivedNotification ;
  v-s:notificationLanguage v-ui:RU ;
  v-s:notificationSubject "{{app_name}}. Задача: ознакомиться с документом '{{documentType}}: {{document}}'" ;
  v-s:notificationBody
  """Уважаемый пользователь, {{to}}

Вы получили на ознакомление документ '{{documentType}}: {{document}}'

Задачу направил {{from}}

Используйте ссылки для перехода на нужные страницы:
* Документ: {{document_url}}
* Задача: {{task_url}}
* Все входящие задачи: {{inbox_url}}

Это сообщение сформировано автоматически. Отвечать на него не нужно.
Система {{app_name}}
""" ;
.

s-wf:msg-template-meeting-instruction
  rdf:type v-s:Notification ;
  v-s:hasMessageType v-s:TaskReceivedNotification ;
  v-s:notificationLanguage v-ui:RU ;
  v-s:notificationSubject "{{app_name}}. Задача: поручение по документу '{{documentType}}: {{document}}'" ;
  v-s:notificationBody
  """Уважаемый пользователь, {{to}}

Вы получили поручение по документу '{{documentType}}: {{document}}'

Задачу направил {{from}}

Используйте ссылки для перехода на нужные страницы:
* Документ: {{document_url}}
* Задача: {{task_url}}
* Все входящие задачи: {{inbox_url}}

Это сообщение сформировано автоматически. Отвечать на него не нужно.
Система {{app_name}}
""" ;
.

s-wf:msg-template-meeting-notification
  rdf:type v-s:Notification ;
  v-s:hasMessageType v-s:TaskReceivedNotification ;
  v-s:notificationLanguage v-ui:RU ;
  v-s:notificationSubject "{{app_name}}. Задача: принять отчет об исполнении поручения по документу '{{documentType}}: {{document}}'" ;
  v-s:notificationBody
  """Уважаемый пользователь, {{to}}

Вы получили отчет об исполнении поручения по документу '{{documentType}}: {{document}}'
Пожалуйста, оцените качество исполнения поручения.
После утверждения исполненного поручения система автоматически закроет его как выполненное.

Задачу направил {{from}}

Используйте ссылки для перехода на нужные страницы:
* Документ: {{document_url}}
* Задача: {{task_url}}
* Все входящие задачи: {{inbox_url}}

Это сообщение сформировано автоматически. Отвечать на него не нужно.
Система {{app_name}}
""" ;
.

s-wf:msg-template-universal-notification_approvalEnd
  rdf:type v-s:Notification ;
  v-s:hasMessageType v-s:ProcessFinishNotification ;
  v-s:notificationLanguage v-ui:RU ;
  v-s:notificationSubject "{{app_name}}. Уведомление: завершено утверждение документа '{{documentType}}: {{document}}'" ;
  v-s:notificationBody
  """Уважаемый пользователь, {{to}}

Документ '{{documentType}}: {{document}}' утвержден.
{{document_url}}

Это сообщение сформировано автоматически. Отвечать на него не нужно.
Система {{app_name}}
""" ;
.

s-wf:msg-template-universal-notification_signEnd
  rdf:type v-s:Notification ;
  v-s:hasMessageType v-s:ProcessFinishNotification ;
  v-s:notificationLanguage v-ui:RU ;
  v-s:notificationSubject "{{app_name}}. Уведомление: завершено подписание документа '{{documentType}}: {{document}}'" ;
  v-s:notificationBody
  """Уважаемый пользователь: {{to}}

Документ '{{documentType}}: {{document}}' подписан.
{{document_url}}

Это сообщение сформировано автоматически. Отвечать на него не нужно.
Система {{app_name}}
""" ;
.

s-wf:msg-template-universal-notification_coordinationEnd
  rdf:type v-s:Notification ;
  v-s:hasMessageType v-s:ProcessFinishNotification ;
  v-s:notificationLanguage v-ui:RU ;
  v-s:notificationSubject "{{app_name}}. Уведомление: завершено согласование документа '{{documentType}}: {{document}}'" ;
  v-s:notificationBody
  """Уважаемый пользователь, {{to}}

Документ '{{documentType}}: {{document}}' согласован.
{{document_url}}

Это сообщение сформировано автоматически. Отвечать на него не нужно.
Система {{app_name}}
""" ;
.

s-wf:msg-template-universal-notification_reviewEnd
  rdf:type v-s:Notification ;
  v-s:hasMessageType v-s:ProcessFinishNotification ;
  v-s:notificationLanguage v-ui:RU ;
  v-s:notificationSubject "{{app_name}}. Уведомление: завершено рассмотрение документа '{{documentType}}: {{document}}'" ;
  v-s:notificationBody
  """Уважаемый пользователь, {{to}}

Документ '{{documentType}}: {{document}}' рассмотрен.
{{document_url}}

Это сообщение сформировано автоматически. Отвечать на него не нужно.
Система {{app_name}}
""" ;
.

s-wf:msg-template-universal-notification_prolongate
  rdf:type v-s:Notification ;
  v-s:hasMessageType v-s:OtherNotification ;
  v-s:notificationLanguage v-ui:RU ;
  v-s:notificationSubject "{{app_name}}. Напоминание: подходит к концу срок действия документа '{{documentType}}: {{document}}'" ;
  v-s:notificationBody
  """Уважаемый пользователь,

Подходит к концу срок действия документа '{{documentType}}: {{document}}'.
{{document_url}}

Это сообщение сформировано автоматически. Отвечать на него не нужно.
Система {{app_name}}
""" ;
.

s-wf:msg-template-universal-notification_new-doc
  rdf:type v-s:Notification ;
  v-s:hasMessageType v-s:OtherNotification ;
  v-s:notificationLanguage v-ui:RU ;
  v-s:notificationSubject "{{app_name}}. Уведомление: новый документ '{{documentType}}'" ;
  v-s:notificationBody
  """{{senderOrg}} направляет Вам ж/д квитанцию № {{docNumber}} от {{docDate}}

Это сообщение сформировано автоматически. Отвечать на него не нужно.
Система {{app_name}}
""" ;
.
